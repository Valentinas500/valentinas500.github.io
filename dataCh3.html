<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Practical Data Science With R. Chapter 3</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Valentinas Rudys</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="teaching.html">Teaching</a>
</li>
<li>
  <a href="research.html">Research</a>
</li>
<li>
  <a href="etrics.html">Econometrics</a>
</li>
<li>
  <a href="macro.html">Macroeconomics</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:vrudys@fordham.edu">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Practical Data Science With R. Chapter 3</h1>

</div>


<div id="chapter-3-exploring-data" class="section level5">
<h5>Chapter 3: Exploring Data</h5>
<p>In this chapter, we will cover the basics of how one should use summary statistics to explore data, use simple data visualization to find problems and discuss how to address those problems.</p>
<p>Any data set typically contains a lot of missing values or even worse, incorrect data, due to various reasons. The first step always should be to get to know your data by exploring each variable.</p>
<p>For this chapter, let’s use data set <strong>affairs</strong> from package <strong>wooldridge</strong> based on Dr. Fairs research on affairs with data from a survey by Psychology Today.</p>
<p>Econometric analysis usually begins with us observing some x and y variables that represent some population and we are interested in “explaining variable y in terms of x” or “studying how y varies with changes in x”. However, before we write anything down, we need to think about these three questions: (1) how do we allow for other factors (other than x) to affect y; (2) what is the functional form of the relationship between x and y; (3) how are we sure that ceteris paribus assumption is captured when estimating relationship between x and y?</p>
<pre class="r"><code>data(affairs, package=&#39;wooldridge&#39;)</code></pre>
<p>Full list of variables in affairs data set:</p>
<table style="width:99%;">
<colgroup>
<col width="11%" />
<col width="31%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th>Number</th>
<th>Name of the variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1.</td>
<td>id</td>
<td>identifier</td>
</tr>
<tr class="even">
<td>2.</td>
<td>male</td>
<td>=1 if male</td>
</tr>
<tr class="odd">
<td>3.</td>
<td>age</td>
<td>in years</td>
</tr>
<tr class="even">
<td>4.</td>
<td>yrsmarr</td>
<td>years married</td>
</tr>
<tr class="odd">
<td>5.</td>
<td>kids</td>
<td>=1 if have kids</td>
</tr>
<tr class="even">
<td>6.</td>
<td>relig</td>
<td>5 = very relig., 4 = somewhat, 3 = slightly, 2 = not at all, 1 = anti</td>
</tr>
<tr class="odd">
<td>7.</td>
<td>educ</td>
<td>years schooling</td>
</tr>
<tr class="even">
<td>8.</td>
<td>occup</td>
<td>occupation, reverse Hollingshead scale</td>
</tr>
<tr class="odd">
<td>9.</td>
<td>ratemarr</td>
<td>5 = vry hap marr, 4 = hap than avg, 3 = avg, 2 = smewht unhap, 1 = vry unhap</td>
</tr>
<tr class="even">
<td>10.</td>
<td>naffairs</td>
<td>number of affairs within last year</td>
</tr>
<tr class="odd">
<td>11.</td>
<td>affair</td>
<td>=1 if had at least one affair</td>
</tr>
<tr class="even">
<td>12.</td>
<td>vryhap</td>
<td>ratemarr == 5</td>
</tr>
<tr class="odd">
<td>13.</td>
<td>hapavg</td>
<td>ratemarr == 4</td>
</tr>
<tr class="even">
<td>14.</td>
<td>avgmarr</td>
<td>ratemarr == 3</td>
</tr>
<tr class="odd">
<td>15.</td>
<td>unhap</td>
<td>ratemarr == 2</td>
</tr>
<tr class="even">
<td>16.</td>
<td>vryrel</td>
<td>relig == 5</td>
</tr>
<tr class="odd">
<td>17.</td>
<td>smerel</td>
<td>relig == 4</td>
</tr>
<tr class="even">
<td>18.</td>
<td>slghtrel</td>
<td>relig == 3</td>
</tr>
<tr class="odd">
<td>19.</td>
<td>notrel</td>
<td>relig == 2</td>
</tr>
</tbody>
</table>
<p>Typical problems that can be easily identified when working with data sets are: - incorrectly programmed variables - missing values - invalid values and outliers - data ranges that are too wide or too narrow - units of data do not match</p>
<p>What I mean by incorrectly programmed variables? While technically, it is not always a problem, in R and other statistical software, variables can be binary (1 or 0), ordered (1&lt;2&lt;3), integer, numeric and so on. In many data sets, factor variables are often defined as integer. For example, see ratemarr variable in which people rate their marriages from “very happy marriage” to “very unhappy”.</p>
<pre class="r"><code>class(affairs$ratemarr)</code></pre>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>To redefine as what it actually is - an ordered factor - we can use the following commands: affairs<span class="math inline">\(ratemarr=ordered(affairs\)</span>ratemarr, levels=c(1,2,3,4,5)) levels(affairs$ratemarr) = c(“Very unhappy”, “Somewhat unhappy”, “Average”, “Happy”, “Very happy”)</p>
<pre class="r"><code>head(affairs$ratemarr)</code></pre>
<pre><code>## [1] 4 4 4 4 5 5</code></pre>
<pre class="r"><code>plot(affairs$ratemarr)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Also, let’s make the male gender dummy as a dummy variable.</p>
<pre class="r"><code>affairs$male=factor(affairs$male, levels=c(0,1))
levels(affairs$male) = c(&quot;Female&quot;, &quot;Male&quot;)
head(affairs$male)</code></pre>
<pre><code>## [1] Male   Female Male   Female Female Male  
## Levels: Female Male</code></pre>
<pre class="r"><code>plot(affairs$male)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Similarly, sometimes strings of words in R are read as a bunch of characters, instead of ordered factors. Create this variable and see if it recognizes it as a factor</p>
<pre class="r"><code>affairs$randomvar = c(rep(&quot;A&quot;,300), rep(&quot;B&quot;,301))
class( affairs$randomvar) #not good</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<pre class="r"><code>affairs$randomvar = factor( affairs$randomvar)
class( affairs$randomvar)</code></pre>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<p>If a data set contains only a few missing observations, it may not be a problem. However, if there are a large number of missing values for some variables, we are not able to use them for data analysis without additional work with those variables. Various software as well as commands in R will quietly drop observation rows with missing values. You need to be careful when conducting analysis and follow among other things, the number of observations used in a particular computation.</p>
<p>The most convenient and easy to use command that shows you the basic statistics by variable is <strong>summary</strong>. Using the <strong>summary</strong> command, let’s examine the variables.</p>
<pre class="r"><code>summary(affairs)</code></pre>
<pre><code>##        id           male          age           yrsmarr      
##  Min.   :   4   Female:315   Min.   :17.50   Min.   : 0.125  
##  1st Qu.: 528   Male  :286   1st Qu.:27.00   1st Qu.: 4.000  
##  Median :1009                Median :32.00   Median : 7.000  
##  Mean   :1060                Mean   :32.49   Mean   : 8.178  
##  3rd Qu.:1453                3rd Qu.:37.00   3rd Qu.:15.000  
##  Max.   :9029                Max.   :57.00   Max.   :15.000  
##       kids            relig            educ           occup      
##  Min.   :0.0000   Min.   :1.000   Min.   : 9.00   Min.   :1.000  
##  1st Qu.:0.0000   1st Qu.:2.000   1st Qu.:14.00   1st Qu.:3.000  
##  Median :1.0000   Median :3.000   Median :16.00   Median :5.000  
##  Mean   :0.7155   Mean   :3.116   Mean   :16.17   Mean   :4.195  
##  3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:18.00   3rd Qu.:6.000  
##  Max.   :1.0000   Max.   :5.000   Max.   :20.00   Max.   :7.000  
##     ratemarr        naffairs          affair           vryhap     
##  Min.   :1.000   Min.   : 0.000   Min.   :0.0000   Min.   :0.000  
##  1st Qu.:3.000   1st Qu.: 0.000   1st Qu.:0.0000   1st Qu.:0.000  
##  Median :4.000   Median : 0.000   Median :0.0000   Median :0.000  
##  Mean   :3.932   Mean   : 1.456   Mean   :0.2496   Mean   :0.386  
##  3rd Qu.:5.000   3rd Qu.: 0.000   3rd Qu.:0.0000   3rd Qu.:1.000  
##  Max.   :5.000   Max.   :12.000   Max.   :1.0000   Max.   :1.000  
##      hapavg          avgmarr           unhap            vryrel      
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
##  Median :0.0000   Median :0.0000   Median :0.0000   Median :0.0000  
##  Mean   :0.3228   Mean   :0.1547   Mean   :0.1098   Mean   :0.1165  
##  3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.0000   3rd Qu.:0.0000  
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
##      smerel          slghtrel          notrel       randomvar
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   A:300    
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   B:301    
##  Median :0.0000   Median :0.0000   Median :0.0000            
##  Mean   :0.3161   Mean   :0.2146   Mean   :0.2729            
##  3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:1.0000            
##  Max.   :1.0000   Max.   :1.0000   Max.   :1.0000</code></pre>
<p>For example, looking at variable age, we see that the lowest recorded value is 17.5 and the highest is 57. One would be sure something is not right if age was negative, or below age of 10 when discussing affairs. Similarly, any age above 100 should also be examined. It may be technically possible that there are some 100-year-olds having affairs, it is not very likely. More variation in a variable allows for a more accurate analysis. Also, take a look at outliers, significantly differing value from the rest of the observations, that may have overly strong effect on the statistical analysis. Finally, when doing analysis make sure you keep track of the units of measurement well to avoid confusion and incorrect interpretation. There are many differences that come when income is measured as hourly wage or monthly in thousands of dollars while in the data it may look similar. For example, wage of 5 may mean 5 dollars per hour or 5 thousand dollars per month. Keep track of your units.</p>
<p>To check if we have any missing values, we can use a very simple command. Since it checks all of the points in the data set, and returns a large matrix of TRUES and FALSES, you may want to sum it all up. When you sum up a TRUE_FALSE binary values, TRUE is counted as 1, FALSE as 0.</p>
<pre class="r"><code>head(is.na(affairs))</code></pre>
<pre><code>##      id  male   age yrsmarr  kids relig  educ occup ratemarr naffairs
## 1 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
## 2 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
## 3 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
## 4 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
## 5 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
## 6 FALSE FALSE FALSE   FALSE FALSE FALSE FALSE FALSE    FALSE    FALSE
##   affair vryhap hapavg avgmarr unhap vryrel smerel slghtrel notrel
## 1  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
## 2  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
## 3  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
## 4  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
## 5  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
## 6  FALSE  FALSE  FALSE   FALSE FALSE  FALSE  FALSE    FALSE  FALSE
##   randomvar
## 1     FALSE
## 2     FALSE
## 3     FALSE
## 4     FALSE
## 5     FALSE
## 6     FALSE</code></pre>
<pre class="r"><code>sum(is.na(affairs))</code></pre>
<pre><code>## [1] 0</code></pre>
<p>As data summary statistics can give a lot of information, so does data visualization. We generally call use of graphics to examine data - visualization. We want these visuals or figures to convey as much information as possible without being too difficult to read and they must be clear, and the main results should stand out. We pose questions, graph the data, learn what we can, and regraph the data to answer subsequent questions that may arise from previous figures.</p>
<p>Some of the most popular data visualizations for one variable are histograms, density plots, bar charts and dot plots.</p>
<p>Histograms bins a variable into fixed-width buckets and returns the number of data points that falls into each bucket as a height. To create a histogram, we can use a simple command ‘hist’ or use a set of commands from package ‘ggplot2’. The issue with histograms is that deciding on the width of the bucket may determine what you learn from the figure. Wide bins are easy to read but lose some information while narrow bins may be hard to read.</p>
<pre class="r"><code>hist(affairs$age)
#install.packages(&quot;ggplot2&quot;)
library(ggplot2)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>ggplot(affairs, aes(x=age)) +
              geom_histogram(binwidth=5, fill=&quot;gray&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>Density plots is like a continuous histogram with the area under the plot is rescaled to equal one. When we look at density plot, we are interested in the overall shape of the curve than the actual observed values.</p>
<pre class="r"><code>plot(density(affairs$age))</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>ggplot(affairs, aes(x=age)) + geom_density()</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>In some cases, a transformation of a variable such as a natural log, or log10 can be useful in finding more about your data. You should use a logarithmic scale when percent change, or change in orders of magnitude, is more important than changes in absolute units. You should also use a log scale to better visualize data that is heavily skewed.</p>
<p>A is a histogram for discrete data: it records the frequency of every value of a bar chart categorical variable. For example we can look at the number of survey respondents by how they feel about their marriage from “very unhappy” to “very happy”. While it may be a nice-looking figure, it does not tell us any more than a simple summary statistic.</p>
<pre class="r"><code>A=c(sum(affairs$ratemarr==&quot;Very unhappy&quot;),
  sum(affairs$ratemarr==&quot;Somewhat unhappy&quot;),
  sum(affairs$ratemarr==&quot;Average&quot;),
  sum(affairs$ratemarr==&quot;Happy&quot;),
  sum(affairs$ratemarr==&quot;Very happy&quot;)  )
barplot(A)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>ggplot(affairs, aes(x=ratemarr)) + geom_bar(fill=&quot;gray&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>In some cases, especially when names of the variables are long, one can use a horizontal bar chart or a dot plot. Here, we take a look at the discrete counts of respondents by occupation. In the second graph, we graph a sorted dot plot.</p>
<pre class="r"><code>ggplot(affairs, aes(x=occup)) +
   geom_bar(fill=&quot;gray&quot;) +
   coord_flip() +
  scale_x_continuous(breaks=seq(1,7,1))</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>#install.packages(WVPlots)
library(WVPlots)
ClevelandDotPlot(affairs, &quot;occup&quot;,
   sort = 1, title=&quot;Occupation&quot;) +
   coord_flip()</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>In all the figures above, we looked at one variable at a time. We also typically look at how two variables are related. For that, we can use scatterplot, line plots, bar charts, variations of histograms and density plots.</p>
<p>First, let’s take a look at a scatterplot of number of affairs by age. Using ggplot2 package, we can also easily include a smoothing line which calculates smoothed local linear fits of the data. It allows us to better see what is happening in the data.</p>
<pre class="r"><code>ggplot(affairs, aes(x=age, y=naffairs)) +
  geom_point() +
  ggtitle(&quot;Number of affairs as a function of age&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>#alternatively, one could use a simple plot command:   plot(naffairs~age,data=affairs)

ggplot(affairs, aes(x=age, y=naffairs)) +
   geom_point() + geom_smooth() +
   ggtitle(&quot;Number of affairs as a function of age&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<p>A smoothing curve is also useful in a scatterplot of a continuous and a binary variable. Otherwise, a scatterplot is not very useful. A hexibin plot is like a two-dimensional histogram. The data is divided into bins, and the number of data points in each bin is represented by color or shading. Darker bins = more counts. See figures showing relationships between “very happy” and age, and between “how religious one is” and age.</p>
<pre class="r"><code>BinaryYScatterPlot(affairs, &quot;age&quot;, &quot;vryhap&quot;,
                   title = &quot;Probability of being &#39;very happy&#39; in marriage by age&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>HexBinPlot(affairs, &quot;age&quot;, &quot;relig&quot;, &quot;Religious-ness as a function of age&quot;) +
  geom_smooth(color=&quot;black&quot;, se=FALSE)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<p>We can use bar chart not only for one single variable at a time. We can, for example, look at how people rate their marriage and if they had an affair. The red part of the bar chart indicates the counts of people who did not have an affair according to their rating of their marriage. Since most people rated their marriages as very happy and very few indicated that their marriages are “very unhappy”, we can normalize each category to 1. The last figure (plot 4) shows the fraction of people who had an affair by how they rate their marriage.</p>
<pre class="r"><code>affairs$affair=factor(affairs$affair)
levels(affairs$affair)=c(&quot;No&quot;,&quot;Yes&quot;)

#Plot 1
ggplot(affairs, aes(x=ratemarr, fill=affair)) +
  geom_bar()</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>#Plot 2
ggplot(affairs, aes(x=ratemarr, fill=affair)) +
  geom_bar(position = &quot;dodge&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<pre class="r"><code>#Plot 3
ShadowPlot(affairs, &quot;ratemarr&quot;, &quot;affair&quot;,
           title = &quot;Affairs by Happines in Marriage&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<pre class="r"><code>#Plot 4
ggplot(affairs, aes(x=ratemarr, fill=affair)) +
  geom_bar(position = &quot;fill&quot;)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<p>Using a horizontal bar, we can examine the relationship between gender and how people rate their marriages. We see that in our dataset, men tend to rate their marriages more in the middle, women are slightly more likely to rate marriages at one of the extreme options.</p>
<pre class="r"><code>ggplot(affairs, aes(x=ratemarr, fill=male)) +
  geom_bar(position = &quot;dodge&quot;) +
  scale_fill_brewer(palette = &quot;Dark2&quot;) +
  coord_flip()</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>ggplot(affairs, aes(x=ratemarr)) +
  geom_bar(fill=&quot;darkgray&quot;) +
  facet_wrap(~male, scale=&quot;free_x&quot;) +
  coord_flip()</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<p>We can also superimpose density plots. For example, let’s look at individuals who had and who did not have an affair by age. ggplot(affairs, aes(x=age, color=affair, linetype=affair)) + geom_density() + scale_color_brewer(palette=“Dark2”)</p>
<pre class="r"><code>ShadowHist(affairs, &quot;age&quot;, &quot;affair&quot;,
           &quot;Age distribution for people engaged in and not engaged in affairs&quot;,
           binwidth=5) </code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Similarly, we can examine the age distributions of our data by a specific category. For example, lets look at the density plots by how people rate their marriage. We see that young people tend to rate their marriages overwhelmingly “happy” or “very happy”.</p>
<pre class="r"><code>ggplot(affairs, aes(x=age)) +
  geom_density() + facet_wrap(~ratemarr)</code></pre>
<p><img src="dataCh3_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p><strong>References</strong></p>
<p>Zumel, N., &amp; Mount, J. (2014). Practical Data Science With R. Manning Publications Co.</p>
<p>Wooldridge, J. (2019). Introductory econometrics: a modern approach. Boston, MA: Cengage.</p>
<hr />
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
